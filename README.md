# Что такое докер? Зачем докер? Для чего докер? Куда докер? Оставьте да меня
Цитирую: 
" Докер — это открытая платформа для разработки, доставки и эксплуатации приложений. Docker разработан для более быстрого выкладывания ваших приложений. С помощью docker вы можете отделить ваше приложение от вашей инфраструктуры и обращаться с инфраструктурой как управляемым приложением. Docker помогает выкладывать ваш код быстрее, быстрее тестировать, быстрее выкладывать приложения и уменьшить время между написанием кода и запуска кода. Docker делает это с помощью легковесной платформы контейнерной виртуализации, используя процессы и утилиты, которые помогают управлять и выкладывать ваши приложения. "

# Зачем контейнер, когда есть виртуалка? 
А вот здесь картинка нужна
![скачай нормальный браузер](./pics/containers-vs-virtual-machines.jpeg)


# Архитектура докера. Быстренько
1) Использует клиент-серверную архитектуру 
2) Основные компоненты: Докер демон, Докер клиент, Докер Десктоп, Докер реестр, Докер объекты
3) Сеть 
    1) bridge (мост)
    2) host 
    3) overlay
    4) ipvlan
    5) macvlan
    6) none

Тезисно
bridge-сети лучше всего подходят, когда вам нужно, чтобы несколько контейнеров взаимодействовали друг с другом на одном докер хосте

host-сети лучше всего подходят, когда нужно, чтобы сам сетевой стек не был изолирован от хоста, но другие компоненты были изолированы

overlay-сети лучше всего подходят, когда вам нужны контейнеры, запущенные на разных докер хостах для коммуникации или когда несколько приложений работают, используя swarm cервисы 

macvlan-сети больше всего подходят, когда вы мигрируете с vm-сборки или нужно, чтобы 
контейнеры вели себя, как физические хосты в вашей сети, где у каждого девайса есть уникальный мак адрес

Сторонние плагины позволяют интегрировать докер со специализированным сетевым стэком. 

Базовые команды

docker network ls - просмотреть список доступных сетей
docker network inspect <network_name> - инспектировать свойства какой-то одной сети
docker network create --driver <driver_name> <network_name> - создать какую-либо сеть

4) Хранение данных
Ключевые понятия относительно хранения данных в докере: 
1) Том
2) Bind mount
3) tmpfs (только в линухе)


# Экзамплы
1) Простенький сервер на питончике
2) Овервью нетворкинга в докере
## Bridge сети, User-defined bridge networks

## Host сети
```bash 
docker run --rm -d --network host --name my_nginx nginx
```
## Macvlan сети
```bash
 docker network create -d macvlan \
  --subnet=172.16.86.0/24 \
  --gateway=172.16.86.1 \
  -o parent="en0" macnet
```
по какой-то причине macvlan сеть не работает на маке, когда пытаешься использовать en0 
в качестве родительского интерфейса. Вот открытый [issue](https://github.com/moby/libnetwork/issues/2614)

## Overlay сети
3) Поднять kali в докере? Изи 
```bash
sudo docker run --rm -i -t kalilinux/kali-rolling /bin/bash 
```

4) Поднять PostgreSQL сервер? Изи
```bash 
sudo docker run -e POSTGRES_HOST_AUTH_METHOD=trust -v postgres-storage:/data --name postgresql postgres  
docker exec -it postgresql psql -U postgres -d postgres
docker exec -i postgresql psql -U postgres -d postgres < postgresql/migration.sql
```

5) Поднять докер в докере? Ну, как бы так сказать
```
docker run -v /var/run/docker.sock:/var/run/docker.sock -ti docker
```
Вроде бы, все работает, но если ты думаешь, что все реально работает, то ты глубоко заблуждаешься. А запусти команду 
```bash
docker ps
```

# Cсылки
[Неплохая вводная статья на хабре](https://habr.com/ru/post/253877/)\
[Статья о хранении данных в докере](https://slurm.io/tpost/i5ikrm9fj1-hranenie-dannih-v-docker)\
[bridge-cеть в докере](https://docs.docker.com/network/bridge/)\
[хост-сеть в докере](https://docs.docker.com/network/host/)\
[докер на го](https://github.com/moby/moby)

